<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<script
        src="https://code.jquery.com/jquery-3.7.0.js"
        integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM="
        crossorigin="anonymous"></script>
<script>

  function sendMsg2(){
    var msg = document.getElementById("sendMsg").value;
    socket.send(JSON.stringify({
      uid:"192.168.1.18",
      msg:msg
    }))
  }
</script>
<body>
<form onsubmit="return false">
  <textarea id="responseText" style="height: 150px; width: 300px;" readonly></textarea>


  <textarea id="sendMsg" style="height: 150px;width:300px"></textarea>

  <input onclick="sendMsg2();" type="button" value="发送消息"/>
</form>


</body>
<script type="text/javascript">

  var socket;
  // 判断当前浏览器是否支持webSocket
  if(window.WebSocket){
    socket = new WebSocket("ws://192.168.1.18:58080/webSocket")
    // 相当于channel的read事件，ev 收到服务器回送的消息
    socket.onmessage = function (ev) {
      var rt = document.getElementById("responseText");
      rt.value = rt.value + "\n" + ev.data;
    }
    // 相当于连接开启
    socket.onopen = function (ev) {
      var rt = document.getElementById("responseText");
      rt.value =  "加入连接"
      socket.send(
              JSON.stringify({
                // 连接成功将，用户ID传给服务端
                uid: "192.168.1.18"
              })
      );
    }
    // 相当于连接关闭
    socket.onclose = function (ev) {
      var rt = document.getElementById("responseText");
      rt.value = rt.value + "\n" + "连接关闭了...";
    }
  }else{
    alert("当前浏览器不支持webSocket")
  }



</script>
</html>
